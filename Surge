[General]
# General
http-listen = 0.0.0.0:8888
socks5-listen = 0.0.0.0:8889
external-controller-access = tutu@0.0.0.0:6170
force-http-engine-hosts = boxjs.com, boxjs.net
# Lateracy
internet-test-url = http://wifi.vivo.com.cn/generate_204
proxy-test-url = http://cp.cloudflare.com/generate_204
test-timeout = 3
ipv6 = false
show-error-page-for-reject = true
# DNS
hijack-dns = *:53
dns-server = 119.29.29.29, 223.5.5.5, system
# Advanced
loglevel = notify
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, 17.0.0.0/8, localhost, *.local, *.crashlytics.com
exclude-simple-hostnames = true
use-default-policy-if-wifi-not-primary = false
# Others
allow-wifi-access = true
hide-vpn-icon = true
# network-framework = true
http-api = tutu@0.0.0.0:2500
http-api-web-dashboard = true
encrypted-dns-server = https://dns.alidns.com/dns-query

[Replica]
hide-apple-request = true
hide-crashlytics-request = true
hide-udp = false
keyword-filter-type = false

[Proxy]

[Proxy Group]
Final = select, CN, Proxy //final ç­–ç•¥ç»„
AllServer = select, policy-path=https://sub.store/download/collection/Surge, update-interval=0, no-alert=0, hidden=0
Auto = url-test, policy-path=https://sub.store/download/collection/Surge, url=http://cp.cloudflare.com/generate_204, interval=600, tolerance=50
Proxy = fallback, policy-path=https://sub.store/download/collection/Surge, url=http://cp.cloudflare.com/generate_204, interval=600, tolerance=50, hidden=0
HK = url-test, policy-path=https://sub.store/download/collection/Surge, policy-regex-filter=æ¸¯|ðŸ‡­ðŸ‡°|é¦™æ¸¯|HK|Hong, interval=200, tolerance=50, update-interval=43200, no-alert=1, hidden=0, include-all-proxies=0
TW = url-test, policy-path=https://sub.store/download/collection/Surge, policy-regex-filter=å°|ðŸ‡¨ðŸ‡³|ðŸ‡¹ðŸ‡¼|å°æ¹¾|TW|Tai, interval=600, tolerance=50, update-interval=43200, no-alert=1, hidden=0, include-all-proxies=0
JP = url-test, policy-path=https://sub.store/download/collection/Surge, policy-regex-filter=æ—¥|ðŸ‡¯ðŸ‡µ|æ—¥æœ¬|JP|Japan, interval=600, tolerance=50, update-interval=43200, no-alert=1, hidden=0, include-all-proxies=0
SG = url-test, policy-path=https://sub.store/download/collection/Surge, policy-regex-filter=å¡|ðŸ‡¸ðŸ‡¬|æ–°åŠ å¡|ç‹®åŸŽ|SG|Singapore, interval=600, tolerance=50, update-interval=43200, no-alert=1, hidden=0, include-all-proxies=0
US = url-test, policy-path=https://sub.store/download/collection/Surge, policy-regex-filter=ç¾Ž|ðŸ‡ºðŸ‡¸|ç¾Žå›½|US|States|American, interval=600, tolerance=50, update-interval=43200, no-alert=1, hidden=0, include-all-proxies=0
CN = select, DIRECT, hidden=1
Apple = select, Auto, CN, HK, TW, SG, JP, US, AllServer
Bilibili = select, Auto, CN, HK, TW, SG, JP, US, AllServer
Disney = select, Auto, CN, HK, TW, SG, JP, US, AllServer
Netflix = select, Auto, CN, HK, TW, SG, JP, US, AllServer
Speedtest = select, Auto, CN, HK, TW, SG, JP, US, AllServer
Telegram = select, Auto, CN, HK, TW, SG, JP, US, AllServer
YouTube = select, Auto, CN, HK, TW, SG, JP, US, AllServer
Weibo = select, Auto, CN, HK, TW, SG, JP, US, AllServer

[Rule]
# ban UDP on Youtube
AND,((PROTOCOL,UDP), (DOMAIN-SUFFIX,googlevideo.com)),REJECT-NO-DROP
# ban National Anti-fraud Center
DOMAIN,prpr.96110.cn.com,DIRECT
DOMAIN-KEYWORD,96110,REJECT
DOMAIN-SUFFIX,gjfzpt.cn,REJECT
# > Vercel --> sub-store
DOMAIN-SUFFIX,vercel.app,Proxy
# > Spotify
DOMAIN-SUFFIX,ap.spotify.com,DIRECT
# > Google
DOMAIN,mtalk.google.com,DIRECT
DOMAIN,mobile-gtalk.l.google.com,DIRECT
DOMAIN,alt1-mtalk.google.com,DIRECT
DOMAIN,alt2-mtalk.google.com,DIRECT
DOMAIN,alt3-mtalk.google.com,DIRECT
DOMAIN,alt4-mtalk.google.com,DIRECT
DOMAIN,alt5-mtalk.google.com,DIRECT
DOMAIN,alt6-mtalk.google.com,DIRECT
DOMAIN,alt7-mtalk.google.com,DIRECT
DOMAIN,alt8-mtalk.google.com,DIRECT
DOMAIN,alt9-mtalk.google.com,DIRECT
DOMAIN-SUFFIX,mobile-gtalk.l.google.com,DIRECT
# > Proxy
PROCESS-NAME,v2ray,DIRECT
PROCESS-NAME,ss-local,DIRECT
PROCESS-NAME,UUBooster,DIRECT
# > Download
PROCESS-NAME,aria2c,DIRECT
PROCESS-NAME,fdm,DIRECT
PROCESS-NAME,Folx,DIRECT
PROCESS-NAME,NetTransport,DIRECT
PROCESS-NAME,Thunder,DIRECT
PROCESS-NAME,Transmission,DIRECT
PROCESS-NAME,uTorrent,DIRECT
PROCESS-NAME,WebTorrent,DIRECT
PROCESS-NAME,WebTorrent Helper,DIRECT
# > Mail
DOMAIN-SUFFIX,smtp,DIRECT
URL-REGEX,(Subject|HELO|SMTP),DIRECT

# ------Rulesets (è§„åˆ™é›†ï¼‰------
# åˆ é™¤æ³¨é‡Šç¬¦å· â€œ#â€ â€œ;â€ å³å¯å¯ç”¨æ­¤è§„åˆ™ã€‚
# > Advertising (å¹¿å‘Š)
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/AdvertisingLite/AdvertisingLite.list,REJECT-TINYGIF
DOMAIN-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/AdvertisingLite/AdvertisingLite_Domain.list,REJECT-TINYGIF
# > Privacy (éšç§)
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Privacy/Privacy.list,REJECT
DOMAIN-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Privacy/Privacy_Domain.list,REJECT
# > Hijacking (è¿è¥å•†åŠ«æŒæˆ–æ¶æ„ç½‘ç«™)
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Hijacking/Hijacking.list,REJECT
# > Anti-IPCheck é˜»æ–­å¤§é™†appçš„ipæŸ¥è¯¢
RULE-SET,https://raw.fastgit.org/bunizao/TutuBetterRules/tutu/RuleList/DOMAlN/Anti-IPCheck.list,Proxy
# > æµåª’ä½“
RULE-SET,https://raw.fastgit.org/dler-io/Rules/main/Surge/Surge%203/Provider/Media/Bilibili.list,Bilibili
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Disney/Disney.list,Disney
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Netflix/Netflix.list,Netflix
# > Speedtest
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Speedtest/Speedtest.list,Speedtest
# > Apple
RULE-SET,https://raw.fastgit.org/bunizao/TutuBetterRules/tutu/RuleList/DOMAlN/Apple_Direct.list,DIRECT
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Clash/AppleNews/AppleNews.list,US
RULE-SET,https://raw.fastgit.org/bunizao/TutuBetterRules/tutu/RuleList/DOMAlN/Apple_Proxy.list,Proxy
RULE-SET,https://raw.fastgit.org/bunizao/TutuBetterRules/tutu/RuleList/DOMAlN/iCloudPrivateRelay.list,Proxy // iCloud Private Relayï¼šMacOSä¸Šçš„Surgeç½‘å…³æ‰èƒ½ç”¨ iOSä¸éœ€è¦è¯·ç¦ç”¨ã€‚
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple.list,Apple
# > WeChat
#RULE-SET,https://raw.fastgit.org/DivineEngine/Profiles/master/Surge/Ruleset/Extra/WeChat.list,SG
# > TikTok
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/TikTok/TikTok.list,TW
# > YouTube
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/YouTube/YouTube.list,YouTube
RULE-SET,https://raw.fastgit.org/blackmatrix7/ios_rule_script/master/rule/Surge/GoogleSearch/GoogleSearch.list,YouTube
# > Telegram
RULE-SET,https://raw.fastgit.org/bunizao/TutuBetterRules/tutu/RuleList/DOMAlN/Telegram.list,Telegram
# > Global
RULE-SET,https://raw.fastgit.org/DivineEngine/Profiles/master/Surge/Ruleset/Global.list,Proxy
# > China
RULE-SET,https://raw.fastgit.org/DivineEngine/Profiles/master/Surge/Ruleset/China.list,DIRECT
# > Local Area Network å±€åŸŸç½‘
IP-CIDR,192.168.0.0/16,DIRECT
IP-CIDR,10.0.0.0/8,DIRECT
IP-CIDR,172.16.0.0/12,DIRECT
IP-CIDR,127.0.0.0/8,DIRECT
IP-CIDR,100.64.0.0/10,DIRECT
IP-CIDR,224.0.0.0/4,DIRECT
RULE-SET,LAN,DIRECT
# > ASN China
RULE-SET,https://raw.fastgit.org/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.list,DIRECT
# > Final 
FINAL,Final,dns-failed

[Host]
# > è¯¥æ®µå®šä¹‰æœ¬åœ° DNS è®°å½•
# > è¯¥åŠŸèƒ½ç­‰åŒäºŽ /etc/hostsï¼ŒåŠ ä¸Šäº†æ³›è§£æžå’Œåˆ«åæ”¯æŒã€‚
# > Firebase Cloud Messaging
mtalk.google.com = 108.177.125.188
# ===============================================================================
# è¯¥æ®µå®šä¹‰é’ˆå¯¹ HTTP è¯·æ±‚çš„ URL é‡å®šå‘è§„åˆ™

[URL Rewrite]
# > æœ‰ä¸¤ç§é‡å®šå‘æ–¹å¼: 'header' å’Œ '302'
# > å»ºè®®ç”¨æ¨¡å— header
# > ReDIRECT Google Search Service
^(http|https):\/\/(www.)?(g|google)\.cn https://www.google.com 302
# AbeamTV Unlock header
^https?:\/\/api\.abema\.io\/v\d\/ip\/check - reject
# ReDIRECT Google Service
^https?:\/\/(www.)?g\.cn https://www.google.com 302
^https?:\/\/(www.)?google\.cn https://www.google.com 302
# ReDIRECT HTTP to HTTPS
^https?:\/\/(www.)?taobao\.com\/ https://www.taobao.com/ 302
^https?:\/\/(www.)?jd\.com\/ https://www.jd.com/ 302
^https?:\/\/(www.)?mi\.com\/ https://www.mi.com/ 302
^https?:\/\/you\.163\.com\/ https://you.163.com/ 302
^https?:\/\/(www.)?suning\.com/ https://suning.com/ 302
^https?:\/\/(www.)?yhd\.com https://yhd.com/ 302
# ===============================================================================

[MITM]
skip-server-cert-verify = true
tcp-connection = true
h2 = true
hostname = %APPEND% *.abema.tv, *.chelaile.net.cn, *.didistatic.com, *.google-analytics.com, *.googlevideo.com, *.iydsj.com, *.k.sohu.com, *.kfc.com, *.kingsoft-office-service.com, *.meituan.net, *.ofo.com, *.pixiv.net, *.pstatp.com, *.rixcloudservice.com, *.uve.weibo.com, *.wikipedia.org, *.wikiwand.com, *.ydstatic.com, *.youdao.com, *.youtube.com, *.zhuishushenqi.com, 119.18.193.135, 123.59.31.1, 153.3.236.81, 180.101.212.22, 218.11.3.70, 59.151.53.6, a.apicloud.com, a.applovin.com, a.qiumibao.com, a.sfansclub.com, a.wkanx.com, abema.tv, acs.m.taobao.com, act.vip.iqiyi.com, adse.ximalaya.com, api*.musical.ly, api*.tiktokv.com, api-release.wuta-cam.com, api.abema.io, api.bilibili.com, api.daydaycook.com.cn, api.gotokeep.com, api.intsig.net, api.jr.mi.com, api.jxedt.com, api.kkmh.com, api.m.jd.com, api.mgzf.com, api.psy-1.com, api.rr.tv, api.smzdm.com, api.tv.sohu.com, api.wallstreetcn.com, api.weibo.cn, api.xiachufang.com, api.zhihu.com, api.zhuishushenqi.com, api5.futunn.com, app.10086.cn, app.58.com, app.api.ke.com, app.bilibili.com, app.mixcapp.com, app.variflight.com, app.wy.guahao.com, b.zhuishushenqi.com, c.m.163.com, cap.caocaokeji.cn, capi.mwee.cn, cdn.moji.com, channel.beitaichufang.com, client.mail.163.com, cms.daydaycook.com.cn, dspsdk.abreader.com, fdfs.xmcdn.com, gateway.shouqiev.com, gw-passenger.01zhuanche.com, gw.alicdn.com, huichuan.sm.cn, i.weread.qq.com, i.ys7.com, iapi.bishijie.com, iface.iqiyi.com, img*.doubanio.com, img.jiemian.com, interface.music.163.com, ios.wps.cn, m*.amap.com, m.client.10010.com, m.creditcard.ecitic.com, m.ibuscloud.com, m.yap.yahoo.com, mapi.mafengwo.cn, mapi.weibo.com, media.qyer.com, mi.gdt.qq.com, mob.mddcloud.com.cn, mobile-api2011.elong.com, mp.weixin.qq.com, mrobot.pcauto.com.cn, mrobot.pconline.com.cn, ms.jr.jd.com, msspjh.emarbox.com, newsso.map.qq.com, nnapp.cloudbae.cn, open.qyer.com, portal-xunyou.qingcdn.com, pss.txffp.com, r.inews.qq.com, render.alipay.com, res-release.wuta-cam.com, richmanapi.jxedt.com, service.4gtv.tv, smkmp.96225.com, snailsleep.net, sp.kaola.com, ssl.kohsocialapp.qq.com, static.vuevideo.net, static1.keepcdn.com, support.you.163.com, thor.weidian.com, www.dandanzan.com, www.flyertea.com, www.zhihu.com, youtubei.googleapis.com, zhidao.baidu.com, *.music.163.com, *.music.126.net, music.163.com, music.126.net, api.weibo.cn, mapi.weibo.com, *.uve.weibo.com, ios.prod.ftl.netflix.com, trade-acs.m.taobao.com, api.gotokeep.com, *.oxygenplaza.net, sub.store, 
# ===============================================================================
# ä½¿ç”¨ JavaScript æ¥å¯¹ä¿®æ”¹è¯·æ±‚ä½“ã€å“åº”ä½“ã€å®šæ—¶æ‰§è¡Œè„šæœ¬ã€ç‰¹å®šäº‹ä»¶æ‰§è¡Œè„šæœ¬ã€è§„åˆ™åˆ¤å®šã€policy-groupåˆ¤å®šã€æ‰§è¡ŒDNSè§£æžç­‰

[Script]
# > Sub-Store
Sub-Store Core=type=http-request,pattern=^https?:\/\/sub\.store\/((download)|api\/(preview|sync|(utils\/node-info))),script-path=https://git.iqiq.io/sub-store-org/Sub-Store/releases/latest/download/sub-store-1.min.js,requires-body=true,timeout=120,ability=http-client-policy
Sub-Store Simple=type=http-request,pattern=^https?:\/\/sub\.store,script-path=https://git.iqiq.io/sub-store-org/Sub-Store/releases/latest/download/sub-store-0.min.js,requires-body=true
Sub-Store Sync=type=cron,cronexp=0 0 * * *,wake-system=1,timeout=120,script-path=https://git.iqiq.io/sub-store-org/Sub-Store/releases/latest/download/cron-sync-artifacts.min.js
# > BoxJs
Rewrite: BoxJs = type=http-request,pattern=https?:\/\/boxjs\.(com|net),script-path=https://raw.fastgit.org/chavyleung/scripts/master/box/chavy.boxjs.js, requires-body=true, timeout=120
