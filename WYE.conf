[General]
# ---(通用)---
# 延迟测试
# > Internet 测试 URL
internet-test-url = http://www.aliyun.com
# > 代理测速 URL
proxy-test-url = http://www.gstatic.com/generate_204
# > 测试超时（秒）
# test-timeout = 5
# TLS 引擎
# tls-provider = openssl
# IPv6 支持（关闭）
ipv6 = false
# ------
# ---(网络优化)---
# > 增强版 WiFi 助理
# Surge会在WiFi网络不佳时尝试使用数据网络建立连接
wifi-assist = true
# ------
# ---(Wi-Fi 访问)---
allow-wifi-access = false
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153
# ------
# ---(远程控制器)---
# 允许 Surge 请求查看器或 Surge CLI 进行管理控制。
# 如果允许由 Wi-Fi 控制则将「127.0.0.1」修改为「0.0.0.0」
# external-controller-access = password@0.0.0.0:6170
# ------
# ---(兼容性)---
# 兼容模式
# compatibility-mode = 0
# 跳过代理
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, localhost, *.local, mfs.ykimg.com*.ttf
# 排除简单主机名
exclude-simple-hostnames = true
# SSID 组策略
# 当 Wi-Fi 不是首选网络时 SSID 组策略使用默认策略（仅 macOS 版）
# use-default-policy-if-wifi-not-primary = false
# ------
# ---(DNS 服务器)---
# 电信 118.118.118.118
# 联通 116.116.116.116
doh-server = https://dh-dns.global-idc.net/dns-query
# ------
# ---(实验性功能)---
# 使用 Network framework
# network-framework = true
# ------
# ---(高级)---
# 日志级别
loglevel = notify
# 当遇到 REJECT 策略时返回错误页
show-error-page-for-reject = true
# Always Real IP Hosts
# 当 Surge VIF 处理 DNS 问题时，此选项要求 Surge 返回一个真正的 IP 地址，而不是一个假 IP 地址。
# DNS 数据包将被转发到上游 DNS 服务器。
always-real-ip = msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com
# TCP Force HTTP Hosts
# 让 Surge 把 TCP 连接当作 HTTP 请求来处理。Surge HTTP 引擎将处理这些请求，所有的高级功能，如捕获、重写和脚本等都可以使用。
force-http-engine-hosts = *.ott.cibntv.net,123.59.31.1,119.18.193.135,122.14.246.33,175.102.178.52
geoip-maxmind-url = https://cdn.jsdelivr.net/gh/Hackl0us/GeoIP2-CN@release/Country.mmdb
include-all-networks = false

[Replica]
# ---(实验性功能)---
# 0 为关闭，1 为开启
# > 隐藏 Apple 请求
hide-apple-request = 1
# > 隐藏崩溃追踪器请求
hide-crash-reporter-request = 1
# > 隐藏 UDP 会话
hide-udp = 0
# > 关键词过滤器
# none（关闭关键词过滤器） / whitelist（blacklist（仅记录包含关键字的请求）） / blacklist（仅记录不包含关键字的请求） / pattern（匹配通配符的请求）
keyword-filter-type = none
# > 关键词
keyword-filter = (null)
# ------

[Proxy Group]
WIFI/5G = ssid, default = Outbound, cellular = Outbound, "WYE" = DIRECT
Telegram = select, WIFI/5G, no-alert=0, hidden=0
YouTube = select, WIFI/5G, no-alert=0, hidden=0
Steaming = select, WIFI/5G, no-alert=0, hidden=0
Final = select, WIFI/5G, no-alert=0, hidden=0
Bilibili = select, DIRECT, no-alert=0, hidden=0
Apple = select, DIRECT, no-alert=0, hidden=0
PayPal = select, 美国节点, no-alert=0, hidden=0
Outbound = fallback, 魔戒, timeout=0, interval=0, tolerance=0, no-alert=0, hidden=0
香港节点 = url-test, policy-path=https://sub.prpr.hk/node-list/3498/N08YltFjU0/, update-interval=0, policy-regex-filter=(港|HK|(?i)Hong), timeout=0, interval=0, tolerance=50, no-alert=0, hidden=1
台湾节点 = url-test, policy-path=https://sub.prpr.hk/node-list/3498/N08YltFjU0/, update-interval=0, policy-regex-filter=(台湾|台灣|TW|(?i)Taiwan), timeout=0, interval=0, tolerance=50, no-alert=0, hidden=1
狮城节点 = url-test, policy-path=https://sub.prpr.hk/node-list/3498/N08YltFjU0/, update-interval=0, policy-regex-filter=(新加坡|狮城|坡|SG|(?i)Singapore), timeout=0, interval=0, tolerance=50, no-alert=0, hidden=1
日本节点 = url-test, policy-path=https://sub.prpr.hk/node-list/3498/N08YltFjU0/, update-interval=0, policy-regex-filter=(日本|JP|(?i)Japan), timeout=0, interval=0, tolerance=50, no-alert=0, hidden=1
美国节点 = url-test, policy-path=https://sub.prpr.hk/node-list/3498/N08YltFjU0/, update-interval=0, policy-regex-filter=(美国|美國|US|(?i)States|American), timeout=0, interval=0, tolerance=50, no-alert=0, hidden=1
韩国节点 = url-test, policy-path=https://sub.prpr.hk/node-list/3498/N08YltFjU0/, update-interval=0, policy-regex-filter=(韩|韓 | KR|(?i)Han), no-alert=0, timeout=0, tolerance=50, hidden=1
魔戒 = url-test, policy-path=https://mojie.link/api/v1/client/subscribe?token=5876a76f3f3336c47dbb54f6623e994e/, update-interval=0, policy-regex-filter=(港|台|日本), timeout=0, interval=0, tolerance=50, no-alert=0, hidden=1


[Rule]
# 澳门卡动漫专用逻辑规则
AND,((NOT,((RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/BiliBili/BiliBili.list))), (NOT,((RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Bahamut/Bahamut.list))), (CELLULAR-CARRIER,455-07)),DIRECT
# Unbreak 后续规则修正
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Unbreak.list,DIRECT
# Advertising 广告
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list,REJECT
# Privacy 隐私
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Privacy.list,REJECT
# Hijacking 运营商劫持或恶意网站
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list,REJECT
# 应用代理
# SpeedTest
RULE-SET,https://raw.githubusercontent.com/lhie1/Rules/master/Surge/Surge%203/Provider/Speedtest.list,Outbound
# Telegram
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Telegram/TelegramSG.list,Telegram
# PayPal
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/PayPal.list,PayPal
# bilibili 哔哩哔哩
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/BiliBili/BiliBili.list,Bilibili
# YouTube
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/YouTube.list,YouTube
# Streaming 国际流媒体服务
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Streaming.list,Steaming
# Global 全球加速
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Global.list,Outbound
# Apple 服务
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/Apple.list,Apple
# China 中国直连
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/China.list,DIRECT
# GeoIP China
GEOIP,CN,DIRECT
FINAL,Final,dns-failed